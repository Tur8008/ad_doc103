Сервисные функции
=================

Закладка **"Сервис"** представляет собой мощный сервисный блок, предназначенный для атоматизации функций, которые сделают процесс подготовки алкогольных деклараций более понятным и комфортным для пользователя. Сервисный блок состоит из нескольких разделов, в том числе:

* Параметры учета - проверка параметров учета и настроек учетной политики
* Проверка номенклатуры - проверка правильности заполнения справочника "Номенклатура"
* XML-редактор для загрузки, редактирования и выгрузки файлов алкогольной декларации
* Список контрагентов - формирование таблицы со сведениями о контрагентах, задействованных при формировании отчета

Параметры учета
---------------

Для того чтобы наиболее быстро и в полной мере убедиться в том что информационная база в которой Вы работаете настроена корректно Вы можете воспользоваться модулем проверки параметров (см. закладку "Проверка параметров" в сервисном блоке отчета).

.. figure:: _static/serviceblok_1.png

На командной панели только две кнопки - "Проверить параметры учета" и "Проверить дополнительные реквизиты".

По нажатию кнопки "Проверить параметры учета", Вы повторите проверку, выполняемую при первом запуске и сравнит текущие параметры учета с рекомендуемыми.

По нажатию кнопки "Проверить дополнительные реквизиты", можно выполнить проверку наличия дополнительных реквизитов справочников и документов, которые необходимы для корректного формирования алкогольных деклараций.

Подробнее смотрите также в разделе ":ref:`Подготовка-к-работе`"


Проверка номенклатуры
---------------------

От правильности заполнения справочника номенклатуры очень сильно зависит корректность формирования отчета. Например если у элемента справочника номенклатура не заполнено свойство "код товара" тогда сведения о продажах этого элемента номенклатуры в алкогольную декларацию точно не попадут. 

Для того чтобы быть уверенными в правильности заполнения справочника номенклатура Вам необходимо пользоваться данным модулем сервисного блока.

Принцип работы модуля очень прост. Для этого следуйте простой инструкции:

**А.** Заполните поле "Группа номенклатуры". Если в поле будет указана группа номеклатуры, тогда будет выполнена проверка по всем элементам номенклатуры входяшим в выбранную Вами группу. Если в поле будет конкретная номенклатура, тогда будет проверена выбранная номенклатура. 

.. Note::
   Если Вы оставите поле пустым будет выполнена проверка всего справочника номенклатура.
   
.. figure:: _static/serviceblok_2.png

**Б.** Нажмите кнопку **"Выполнить проверку"** и немедленно получите результат. Проверка осуществляется в пределах указанных в поле "Группа номенклатуры". По результатм проверки выводятся только те позиции, в которых есть ошибки. Если ошибки нет на экране появится сообщение "Ошибок не обнаружено!" чего мы Вам искренне желаем:)

.. figure:: _static/serviceblok_3.png

.. Note::
   Из окна обработки можно сразу же перейти к тому элементу справочника, в заполнении которого найдена ошибка. Для этого просто кликните по наименованию, интересующего Вас элемента.

Отчет по номенклатуре
---------------------

По просьбам наших клиентов мы реализовали отчет по номенклатуре. Отчет представляет собой список номенклатуры с расшифровкой значений некоторых реквизитов алкогольной продукции (Производитель, код вида  алкогольной продукции, объем в литрах на единицу измерения номенклатуры).

Внешний вид отчета представлен на рисунке ниже.

.. figure:: _static/serviceblok_4.png

Как видно из рисунка отчет позволяет сформировать ведомость по целому массиву элементов алкогольной продукции (справочник "номенклатура"). При этом если поле "Группа номенклатуры" не заполнено, то отчет будет сформирован по всем элементам справочника номенклатура.  Если Вы хотите вывести отчет по конкретной группе номенклатуры то соответствующее поле нужно заполнить.

Далее все несложно. Нажимаем кнопку "сформировать отчет", а затем при необходимости "Отправить отчет на печать".

Отчет по номенклатуры, как и рассмотренный выше модуль "Проверка номенклатуры" оч. полезен при поиске ошибок в заполнении справочника номенклатура для целей формирования алькогольной декларации. Отчет по номенклатре является отличным дополнением  модуля проверки так как позволяет выявлять неявные ошибки в заполнении справочника, в случаях если указан ошибочный производитель или неверно задан объем,  вместо 0,5 л указан объем 0,33 л.

Отчет "Список контрагентов"
---------------------------

Отчет предназначен для проверки правильности заполнения сведений о контрагентах (*наименование, ИНН, КПП, адресная информация*). При необходимости отчет может быть распечатан (кнопка "отправить на печать").

.. figure:: _static/serviceblok_5.png

XML-редактор файлов выгрузки отчетов
------------------------------------

XML-редактор реализует следующие возможности:

* чтение и редактирование XML-фалов приложений 5, 6, 7, 11 и 12 алкогольной декларации
* сохранение внесенных изменений в новый файл (с присвоением файлу нового идентификатора)
* формирование печатных форм декларации

Несмотря на весьма устрашающий вид, работать с XML-редактором довольно просто. Все главные операционные комманды и поля настроек выведены в верхнюю часть окна (см. рисунок ниже), в том числе:

* Поле **"Имя файла декларации"** должно содержать полный путь к файлу декларации, который необходимо прочитать и вывести в рабочее поле XML-редактора;
* Кнопка (комманда) "Прочитать файл" - по нажатию этой кнопки происходит считывание и анализ загружаемого xml-файла алкогольной декларациии;
* Поле **"Каталог выгрузки"** необходимо при выгрузке отредактированных данных алкогольной декларации в xml-файл, установленного формата;
* Кнопка **"Выгрузить файл"** - по нажатию этой кнопки происходит полностью автоматическое создание файла и выгрузка данных  в этот файл в установленном формате выгрузки xml;
* Кнопка  **"Печать полученных данных"**  предназначена для вывода на экран печатных форм алкогольной декларации.

Для того чтобы прочитать xml-файл любой из поддерживаемых форм алкогольной декларации (в нашем примере это форма 11) необходимо указать к нему путь и нажать кнопку "прочитать файл". После того как файл будет проанализирован все содержащиеся в нем данные будут разобраны по показателям, предусмотренным форматом данных xml для каждой конкретной формы (см. колонки рабочего поля редактора xml).

.. figure:: _static/serviceblok_6.png

Как видно на рисунке выше  все данные сгруппированы по колонкам с определенными показателями, например Код вида продукции ("П00000000003") или "Наименование производителя/импортера". При наведении мыши на элементы шапки таблицы всплывающая подсказка сообщит Вам код показателя согласно спецификации формата выгрузки XML для соответствующей формы (приложения).

После загрузки данных из "входящего" XML-файла основные данные, сгруппированные по показателям выводятся в главную форму. Наименование главной формы совпадает с типом приложения, которому соотвествует исходный загруженный файл XML. Так на рисунке ниже мы видим что прочитанный файл является выгрузкой Формы 11. 

.. figure:: _static/serviceblok_7.png

После загрузки данных из исходного xml-файла мы можем редактировать любые сведения на закладках рабочего поля редактора. Например, давайте отредактируем показатель "Наименование производителя/импортера" ("Ид произв имп") по строке 1. Как видно на рисунке значение в этой ячейке не заполнено в результате ошибки исходного файла. С нашим XML-xml редактором это легко исправить! Посмотрим на рисунок.

.. figure:: _static/serviceblok_8.png

Как видно на рисунке чтобы заполнить наименование производителя не обязательно набирать значение вручную. Когда мы кликнем в ячейку, то инициируем выпадающий список со всеми производителями и импортерами которые содержатся в текущем файле. Если в списке есть то что мы ищем, то мы можем воспользоваться выбором из списка. 

А теперь давайте изменим значение начального остатка по строке 1 т.е. для производителя ОАО "УРАЛАЛКО" (см. рисунок ниже). 

.. figure:: _static/serviceblok_9.png

Уменьшим исходное значение с 3,75 до 1. Результат хорошо виден на следующем скриншоте. Давайте посмотрим?

.. figure:: _static/serviceblok_10.png

Обратите внимание на следующие последствия редактирования ячеек

* После редактирования ячейки изменили свой цвет. При этом зеленая заливка означает, что ячейка была отредактирована непосредственно т.е. вручную. Бежевая заливка ячейки означает, что она была автоматически пересчитана, как следствие измененения значения базовых ячеек (от которых она зависит).
* Все зависимые ячейки были пересчитанные. Например, значение в поле "Конечный остаток".

После редактирования данных в форме XML редактора можно перейти к повторной выгрузке данных. В случае отсутствия ошибок данные будут успешно выгружены. Отрывок содержания файла выгрузки приведен на рисунке.

.. figure:: _static/serviceblok_11.png

И конечно же Вы легко можете сформировать печатные формы алкогольной декларацииДля этого нужно нажать кнопку "Печать полученных данных". Пример печатных форм см. на рисунке.

.. figure:: _static/serviceblok_12.png

